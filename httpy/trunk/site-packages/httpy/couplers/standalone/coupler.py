"""This coupler starts a stand-alone web server.
"""
import inspect
import os
import sys

import httpy
from httpy.couplers.standalone.server import Server, RestartingServer


class Coupler:

    def __init__(self, responder, address=('',8080), threads=10, uid=''):
        """Given an IResponder class or instance, instantiate a server object.
        """

        if inspect.isclass(responder):
            responder = responder()

        plain_jane = (  (httpy.mode.IS_DEPLOYMENT)
                     or (httpy.mode.IS_STAGING)
                     or (sys.platform == 'win32')
                     or ('HTTPY_PLAIN_JANE' in os.environ)
                     or (sys.argv == ['']) # called interactively
                       )
        ServerClass = plain_jane and Server or RestartingServer
        self.server = ServerClass(responder, address, threads, uid)


    def go(self):
        """Wheeeeee!
        """
        self.server.start()
