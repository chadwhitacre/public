from SocketServer import ThreadingTCPServer

from httpy.Handler import Handler


class Server(ThreadingTCPServer):
    """An httpy server.

    Instantiate with a Config object, and start it with start(). We alias
    serve_forever so we are not tied to SocketServer.

    """

    def __init__(self, config):

        self.config = config.copy() # convert to a standard dictionary

        addr = (self.config['ip'], self.config['port'])
        if self.config['mode'] == 'development':
            self.allow_reuse_address = True

        ThreadingTCPServer.__init__(self, addr, Handler)


    start = ThreadingTCPServer.serve_forever
